!function(e,t){"use strict";function i(){var e=c.outerWidth(),t=c.outerHeight();c.attr({width:e,height:t}),d.requireRedraw()}e="default"in e?e.default:e,t="default"in t?t.default:t;var n=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=9,r=61,o=1e3/60,h=250,u=100,l=function(){function t(e){n(this,t),this.canvas=e,this.panX=0,this.panY=0,this.tileSize=21,this.debugRuntime=0,this.redrawRequired=!1,this.lastRedrawTime=0,this.preDrawCallbacks=[],this.postDrawCallbacks=[],this.requireRedraw()}return a(t,[{key:"zoomIn",value:function(){this.zoomTo(this.tileSize+this.tileSize/4)}},{key:"zoomOut",value:function(){this.zoomTo(this.tileSize-this.tileSize/4)}},{key:"zoomTo",value:function(e){if(!this.zoomInProgress&&(e=Math.round(e),e%2===0&&(e+=1),e<s?e=s:e>r&&(e=r),e!==this.tileSize)){this.zoomInProgress=!0;var t=this.tileSize,i=e-t,n=(new Date).getTime(),a=function(){var e=(this.lastRedrawTime-n)/h;e<0?e=0:e>1&&(e=1),this.tileSize=t+e*i,e<1?this.requireRedraw(a):(console.log("tile size",this.tileSize),this.zoomInProgress=!1,this.requireRedraw())}.bind(this);this.requireRedraw(a)}}},{key:"panUp",value:function(){this.panTo({x:this.panX,y:this.panY-1})}},{key:"panRight",value:function(){this.panTo({x:this.panX+1,y:this.panY})}},{key:"panDown",value:function(){this.panTo({x:this.panX,y:this.panY+1})}},{key:"panLeft",value:function(){this.panTo({x:this.panX-1,y:this.panY})}},{key:"panTo",value:function(e){var t=e.x,i=e.y;if(!this.panInProgress&&(t=Math.round(t),i=Math.round(i),t!==this.panX||i!==this.panY)){this.panInProgress=!0;var n=this.panX,a=this.panY,s=t-n,r=i-a,o=Math.sqrt(s*s+r*r),h=o*u,l=(new Date).getTime(),c=function(){var e=(this.lastRedrawTime-l)/h;e<0?e=0:e>1&&(e=1),this.panX=n+e*s,this.panY=a+e*r,e<1?this.requireRedraw(c):(console.log("pan center",this.panX,this.panY),this.panInProgress=!1,this.requireRedraw())}.bind(this);this.requireRedraw(c)}}},{key:"requireRedraw",value:function(e,t){if("function"==typeof e&&this.preDrawCallbacks.push(e),"function"==typeof t&&this.postDrawCallbacks.push(t),!this.redrawRequired)if(this.redrawRequired=!0,window.requestAnimationFrame)window.requestAnimationFrame(this.redraw.bind(this));else{var i=o-((new Date).getTime()-this.lastRedrawTime);window.setTimeout(this.redraw.bind(this),i>0?i:0)}}},{key:"redraw",value:function(){if(++this.debugRuntime>1e4)return void e(this.canvas).remove();this.redrawRequired=!1,this.lastRedrawTime=(new Date).getTime();var t=this.preDrawCallbacks;this.preDrawCallbacks=[],t.forEach(function(e){e()}),this.drawGrid();var i=this.postDrawCallbacks;this.postDrawCallbacks=[],i.forEach(function(e){e()})}},{key:"drawGrid",value:function(){var e=this.canvas.width,t=this.canvas.height,i=this.tileSize,n=this.canvas.getContext("2d");n.clearRect(0,0,e,t),n.lineWidth=1,n.strokeStyle="blue",n.strokeRect(0,0,e,t),n.beginPath();for(var a=(e-i)/2%i-i*(this.panX%1);a<e;a+=i)n.moveTo(a,0),n.lineTo(a,t);for(var s=(t-i)/2%i-i*(this.panY%1);s<t;s+=i)n.moveTo(0,s),n.lineTo(e,s);n.closePath(),n.lineWidth=1,n.strokeStyle="rgba(0,0,0,.2)",n.stroke()}}]),t}(),c=(function(){function e(){n(this,e),this.grid={}}return a(e,[{key:"get",value:function(e,t){return(this.grid[e]||{})[t]}},{key:"toggle",value:function(e,t){var i=this.grid[e]||(this.grid[e]={});return i[t]=!i[t],i[t]}}]),e}(),e("canvas")),p=c[0],d=new l(p);window.canvasview=d;var w=new t(c[0]);w.get("swipe").set({direction:t.DIRECTION_ALL}),w.get("pan").set({enable:!1}),w.on("swipeup swiperight swipedown swipeleft",function(e){switch(e.type){case"swipeup":d.panUp();break;case"swiperight":d.panRight();break;case"swipedown":d.panDown();break;case"swipeleft":d.panLeft()}}),w.on("tap",function(e){console.log(e.type,e.center)}),w.on("doubletap",function(e){console.log(e.type,arguments)}),w.on("press",function(e){console.log(e.type,arguments)}),Mousetrap.bind("up",function(){d.panUp()}),Mousetrap.bind("right",function(){d.panRight()}),Mousetrap.bind("down",function(){d.panDown()}),Mousetrap.bind("left",function(){d.panLeft()}),e(window).on("mousewheel",function(e){e.deltaY>0?d.zoomIn():e.deltaY&&d.zoomOut()}),i();var f;e(window).on("resize",function(){f&&clearTimeout(f),f=setTimeout(function(){f=null,i()},100)}),console.log("icemaze loaded!")}($,Hammer);
//# sourceMappingURL=compiled.js.map
